<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Accommodation Booking | The Village Hub</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css">
  <script src="script.js"></script>
  <style>
    .slideshow-container {
      position: relative;
      max-width: 100%;
      margin: 2rem auto;
    }
    .slides {
      display: flex;
      overflow: hidden;
      scroll-behavior: smooth;
      border-radius: 12px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    .slide {
      flex: 0 0 100%;
      transition: transform 0.5s ease;
    }
    .slide img {
      width: 100%;
      height: auto;
      object-fit: cover;
    }
    .slideshow-prev, .slideshow-next {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(138, 154, 91, 0.8);
      color: white;
      border: none;
      padding: 10px;
      border-radius: 50%;
      cursor: pointer;
      z-index: 10;
      font-size: 1.2rem;
    }
    .slideshow-prev:hover, .slideshow-next:hover {
      background: rgba(138, 154, 91, 1);
    }
    .slideshow-prev {
      left: 15px;
    }
    .slideshow-next {
      right: 15px;
    }
    .dot {
      width: 12px;
      height: 12px;
      background: rgba(138, 154, 91, 0.3);
      border-radius: 50%;
      display: inline-block;
      margin: 0 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .dot.active {
      background: rgba(138, 154, 91, 1);
    }

    .suite-card { transition: all .25s ease; border-left: 4px solid transparent; }
.suite-card:hover { transform: translateY(-4px); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.12); }
    .ember { border-left-color: #e53e3e; }
    .sol   { border-left-color: #ecc94b; }
    .olive { border-left-color: #48bb78; }
    .azure { border-left-color: #4299e1; }
    .slate { border-left-color: #718096; }
    .pill { font-size: 12px; line-height: 1; padding: 6px 10px; border-radius: 999px; font-weight: 600; }
    .btn-disabled { opacity: .55; cursor: not-allowed; }
  </style>
</head>

<body class="font-sans antialiased bg-white">
  <custom-navbar></custom-navbar>

  <!-- HERO -->
  <section class="bg-[#FAF8F6] py-14">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-[#6B4423]">The Village Suites</h1>
        <p class="mt-4 text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto">
          A peaceful stay in Nooitgedacht Village ‚Äî modern comfort meets winelands calm.
        </p>
      </div>

      <!-- SEARCH / AVAILABILITY -->
      <div class="mt-10 bg-white rounded-xl shadow-md p-5 sm:p-6 max-w-3xl mx-auto">
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">Check-in</label>
            <input id="globalCheckIn" type="date"
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]" />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Check-out</label>
            <input id="globalCheckOut" type="date"
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]" />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Guests</label>
            <select id="globalGuests"
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]">
              <option value="1">1 guest</option>
              <option value="2">2 guests</option>
            </select>
          </div>
        </div>
          <div class="mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
<button id="checkBtn"
            class="w-full sm:w-auto bg-[#8A9A5B] text-white py-2 px-5 rounded-md hover:bg-[#6F7A45] transition-colors">
            Check availability
          </button>

          <div class="text-sm text-gray-600">
            <span class="font-semibold">Minimum stay:</span> 2 nights ¬∑ <span class="font-semibold">Sleeps:</span> 1‚Äì2 guests
          </div>
        </div>

        <div id="globalError" class="mt-3 text-sm text-red-600 hidden">
        </div>
        
        <!-- Slideshow Section -->
        <div class="mt-12 slideshow-container max-w-4xl mx-auto">
          <div class="slides">
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/Foundry%20outside.png" alt="Foundry outside view" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/Gemini_Generated_Image_b0twc4b0twc4b0tw.png" alt="Suite interior" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/WhatsApp%20Image%202025-12-15%20at%2010.06.40%20(9).jpeg" alt="Suite bathroom" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/WhatsApp%20Image%202025-12-15%20at%2010.06.40%20(2).jpeg" alt="Suite bedroom" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/WhatsApp%20Image%202025-12-15%20at%2010.06.40.jpeg" alt="Suite living area" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/WhatsApp%20Image%202025-12-15%20at%2010.06.40%20(15).jpeg" alt="Suite kitchenette" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/imgi_192_189_16682f7a493449b68932b9a91d6a6809_t_w_1440_h_900.jpg" alt="Suite workspace" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/imgi_202_c912ec8b-37e7-467a-cc2f-0274811ae719.jpg" alt="Suite relaxing area" class="w-full h-auto rounded-lg shadow-md">
            </div>
            <div class="slide">
              <img src="https://huggingface.co/spaces/Mariusvj86/the-village-hub/resolve/main/images/imgi_177_189_7ed786941702477d8f00a9713f621af0_t_w_1440_h_900.jpg" alt="Suite exterior" class="w-full h-auto rounded-lg shadow-md">
            </div>
          </div>
          <button class="slideshow-prev absolute left-4 top-1/2 transform -translate-y-1/2 bg-[#8A9A5B]/80 text-white p-2 rounded-full">
            ‚ùÆ
          </button>
          <button class="slideshow-next absolute right-4 top-1/2 transform -translate-y-1/2 bg-[#8A9A5B]/80 text-white p-2 rounded-full">
            ‚ùØ
          </button>
          <div class="flex justify-center mt-4 space-x-2">
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
            <span class="dot w-3 h-3 bg-[#8A9A5B]/30 rounded-full cursor-pointer"></span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- SUITES -->
<section class="py-14">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

      <div class="flex items-end justify-between gap-4 flex-wrap">
        <div>
          <h2 class="text-2xl sm:text-3xl font-extrabold text-[#6B4423]">Choose your suite</h2>
          <p class="text-gray-600 mt-1">Availability updates after you select dates and click ‚ÄúCheck availability‚Äù.</p>
        </div>
        <div id="rangeLabel" class="text-sm text-gray-600"></div>
      </div>

      <div class="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">

        <!-- Ember -->
        <div class="suite-card ember bg-white rounded-lg shadow-md p-6">
          <div class="flex justify-between items-start gap-3">
            <h3 class="text-2xl font-bold text-[#6B4423]">Ember Suite</h3>
            <span class="pill bg-red-100 text-red-800">EMBER</span>
          </div>

          <p class="mt-3 text-sm text-gray-600">Sleeps 2 ¬∑ King/Twin ¬∑ Kitchenette ¬∑ Shower ¬∑ Wi-Fi</p>

          <div class="mt-4 space-y-2 text-sm text-gray-700">
            <div>üõè Two single beds (convertible to a King)</div>
            <div>üì∫ Smart TV + unlimited Wi-Fi</div>
            <div>üç≥ Compact kitchenette for light meals</div>
            <div>üöø Private bathroom with walk-in shower</div>
            <div>‚ú® 20% off Village Hub Co-Working</div>
          </div>

          <div class="mt-6 flex items-center justify-between">
            <div class="text-2xl font-bold text-[#6B4423]">R1,350 <span class="text-base font-normal text-gray-600">/ night</span></div>
            <div id="availability-ember" class="text-sm font-semibold text-gray-500">‚Äî</div>
          </div>

          <button data-suite="Ember Suite" data-key="ember"
            class="mt-4 w-full bg-[#8A9A5B] text-white py-2 px-4 rounded-md hover:bg-[#6F7A45] transition-colors suiteBookBtn btn-disabled"
            disabled>
            Request booking
          </button>
        </div>

        <!-- Sol -->
        <div class="suite-card sol bg-white rounded-lg shadow-md p-6">
          <div class="flex justify-between items-start gap-3">
            <h3 class="text-2xl font-bold text-[#6B4423]">Sol Suite</h3>
            <span class="pill bg-yellow-100 text-yellow-800">SOL</span>
          </div>

          <p class="mt-3 text-sm text-gray-600">Sleeps 2 ¬∑ King/Twin ¬∑ Kitchenette ¬∑ Shower ¬∑ Wi-Fi</p>

          <div class="mt-4 space-y-2 text-sm text-gray-700">
            <div>üõè Two single beds (convertible to a King)</div>
            <div>üì∫ Smart TV + unlimited Wi-Fi</div>
            <div>üç≥ Compact kitchenette for light meals</div>
            <div>üöø Private bathroom with walk-in shower</div>
            <div>‚ú® 20% off Village Hub Co-Working</div>
          </div>

          <div class="mt-6 flex items-center justify-between">
            <div class="text-2xl font-bold text-[#6B4423]">R1,350 <span class="text-base font-normal text-gray-600">/ night</span></div>
            <div id="availability-sol" class="text-sm font-semibold text-gray-500">‚Äî</div>
          </div>

          <button data-suite="Sol Suite" data-key="sol"
            class="mt-4 w-full bg-[#8A9A5B] text-white py-2 px-4 rounded-md hover:bg-[#6F7A45] transition-colors suiteBookBtn btn-disabled"
            disabled>
            Request booking
          </button>
        </div>

        <!-- Olive -->
        <div class="suite-card olive bg-white rounded-lg shadow-md p-6">
          <div class="flex justify-between items-start gap-3">
            <h3 class="text-2xl font-bold text-[#6B4423]">Olive Suite</h3>
            <span class="pill bg-green-100 text-green-800">OLIVE</span>
          </div>

          <p class="mt-3 text-sm text-gray-600">Sleeps 2 ¬∑ King/Twin ¬∑ Kitchenette ¬∑ Shower ¬∑ Wi-Fi</p>

          <div class="mt-4 space-y-2 text-sm text-gray-700">
            <div>üõè Two single beds (convertible to a King)</div>
            <div>üì∫ Smart TV + unlimited Wi-Fi</div>
            <div>üç≥ Compact kitchenette for light meals</div>
            <div>üöø Private bathroom with walk-in shower</div>
            <div>‚ú® 20% off Village Hub Co-Working</div>
          </div>

          <div class="mt-6 flex items-center justify-between">
            <div class="text-2xl font-bold text-[#6B4423]">R1,350 <span class="text-base font-normal text-gray-600">/ night</span></div>
            <div id="availability-olive" class="text-sm font-semibold text-gray-500">‚Äî</div>
          </div>

          <button data-suite="Olive Suite" data-key="olive"
            class="mt-4 w-full bg-[#8A9A5B] text-white py-2 px-4 rounded-md hover:bg-[#6F7A45] transition-colors suiteBookBtn btn-disabled"
            disabled>
            Request booking
          </button>
        </div>

        <!-- Azure -->
        <div class="suite-card azure bg-white rounded-lg shadow-md p-6">
          <div class="flex justify-between items-start gap-3">
            <h3 class="text-2xl font-bold text-[#6B4423]">Azure Suite</h3>
            <span class="pill bg-blue-100 text-blue-800">AZURE</span>
          </div>

          <p class="mt-3 text-sm text-gray-600">Sleeps 2 ¬∑ King/Twin ¬∑ Kitchenette ¬∑ Shower ¬∑ Wi-Fi</p>

          <div class="mt-4 space-y-2 text-sm text-gray-700">
            <div>üõè Two single beds (convertible to a King)</div>
            <div>üì∫ Smart TV + unlimited Wi-Fi</div>
            <div>üç≥ Compact kitchenette for light meals</div>
            <div>üöø Private bathroom with walk-in shower</div>
            <div>‚ú® 20% off Village Hub Co-Working</div>
          </div>

          <div class="mt-6 flex items-center justify-between">
            <div class="text-2xl font-bold text-[#6B4423]">R1,350 <span class="text-base font-normal text-gray-600">/ night</span></div>
            <div id="availability-azure" class="text-sm font-semibold text-gray-500">‚Äî</div>
          </div>

          <button data-suite="Azure Suite" data-key="azure"
            class="mt-4 w-full bg-[#8A9A5B] text-white py-2 px-4 rounded-md hover:bg-[#6F7A45] transition-colors suiteBookBtn btn-disabled"
            disabled>
            Request booking
          </button>
        </div>

        <!-- Slate -->
        <div class="suite-card slate bg-white rounded-lg shadow-md p-6">
          <div class="flex justify-between items-start gap-3">
            <h3 class="text-2xl font-bold text-[#6B4423]">Slate Suite</h3>
            <span class="pill bg-gray-100 text-gray-800">SLATE</span>
          </div>

          <p class="mt-3 text-sm text-gray-600">Sleeps 2 ¬∑ King/Twin ¬∑ Kitchenette ¬∑ Shower ¬∑ Wi-Fi</p>

          <div class="mt-4 space-y-2 text-sm text-gray-700">
            <div>üõè Two single beds (convertible to a King)</div>
            <div>üì∫ Smart TV + unlimited Wi-Fi</div>
            <div>üç≥ Compact kitchenette for light meals</div>
            <div>üöø Private bathroom with walk-in shower</div>
            <div>‚ú® 20% off Village Hub Co-Working</div>
          </div>

          <div class="mt-6 flex items-center justify-between">
            <div class="text-2xl font-bold text-[#6B4423]">R1,350 <span class="text-base font-normal text-gray-600">/ night</span></div>
            <div id="availability-slate" class="text-sm font-semibold text-gray-500">‚Äî</div>
          </div>

          <button data-suite="Slate Suite" data-key="slate"
            class="mt-4 w-full bg-[#8A9A5B] text-white py-2 px-4 rounded-md hover:bg-[#6F7A45] transition-colors suiteBookBtn btn-disabled"
            disabled>
            Request booking
          </button>
        </div>

      </div>
    </div>
  </section>

  <!-- BOOKING MODAL -->
  <div id="bookingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold text-[#6B4423]" id="modalTitle">Request Booking</h3>
        <button id="closeModalBtn" class="text-gray-500 hover:text-gray-700">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <div id="modalError" class="mb-3 text-sm text-red-600 hidden"></div>

      <!-- NETLIFY FORM -->
      <form id="bookingForm" name="suite-booking" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" class="space-y-4">
        <!-- required for Netlify Forms -->
        <input type="hidden" name="form-name" value="suite-booking" />
        <p class="hidden">
          <label>Don‚Äôt fill this out: <input name="bot-field" /></label>
        </p>

        <input type="hidden" id="suiteType" name="suite" />
        <input type="hidden" id="suiteKey" name="suiteKey" />

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="checkIn" class="block text-sm font-medium text-gray-700">Check-in</label>
            <input type="date" id="checkIn" name="checkIn" required
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]">
          </div>
          <div>
            <label for="checkOut" class="block text-sm font-medium text-gray-700">Check-out</label>
            <input type="date" id="checkOut" name="checkOut" required
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]">
          </div>
        </div>

        <div>
          <label for="guests" class="block text-sm font-medium text-gray-700">Guests (1‚Äì2)</label>
          <input type="number" id="guests" name="guests" min="1" max="2" value="1" required
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]">
        </div>

        <div>
          <label for="name" class="block text-sm font-medium text-gray-700">Full Name</label>
          <input type="text" id="name" name="name" required
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]">
        </div>

        <div>
          <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
          <input type="email" id="email" name="email" required
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]">
        </div>

        <div>
          <label for="phone" class="block text-sm font-medium text-gray-700">Phone</label>
          <input type="tel" id="phone" name="phone" required
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]">
        </div>

        <div>
          <label for="notes" class="block text-sm font-medium text-gray-700">Special requests</label>
          <textarea id="notes" name="notes" rows="3"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#8A9A5B] focus:ring-[#8A9A5B]"></textarea>
        </div>

        <div class="flex justify-end gap-3 pt-1">
          <button type="button" id="cancelBtn"
            class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
            Cancel
          </button>
          <button type="submit" id="submitBtn"
            class="px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-[#8A9A5B] hover:bg-[#6F7A45]">
            Submit request
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="fixed bottom-5 right-5 z-[60] hidden">
    <div id="toastInner" class="max-w-sm rounded-lg shadow-lg bg-[#0F172A] text-white px-4 py-3">
      <div class="font-semibold" id="toastTitle">Thanks!</div>
      <div class="text-sm text-white/90 mt-1" id="toastMsg">
        We will confirm your booking as soon as it‚Äôs successfully processed.
      </div>
    </div>
  </div>

  <custom-footer></custom-footer>

  <script src="components/navbar.js"></script>
  <script src="components/footer.js"></script>
  <style>
    .slideshow-container {
      max-width: 100%;
      position: relative;
    }
    .slides {
      display: flex;
      transition: transform 0.5s ease;
    }
    .slide {
      flex: 0 0 100%;
    }
    .slideshow-prev, .slideshow-next {
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .slideshow-prev:hover, .slideshow-next:hover {
      background-color: white;
    }
    .dot.active {
      background-color: white;
    }
  </style>
  <script>
    // Initialize slideshow
    document.addEventListener('DOMContentLoaded', function() {
      const slideshowContainer = document.querySelector('.slideshow-container');
      if (!slideshowContainer) return;

      // Slideshow functionality
document.addEventListener('DOMContentLoaded', function() {
      const slides = document.querySelector('.slides');
      const slideItems = document.querySelectorAll('.slide');
      const dots = document.querySelectorAll('.dot');
      const prevBtn = document.querySelector('.slideshow-prev');
      const nextBtn = document.querySelector('.slideshow-next');
      
      let currentIndex = 0;
      const totalSlides = slideItems.length;

      function updateSlide() {
        slides.style.transform = `translateX(-${currentIndex * 100}%)`;
        
        // Update dots
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === currentIndex);
        });
      }

      // Next slide
      nextBtn.addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % totalSlides;
        updateSlide();
      });

      // Previous slide
      prevBtn.addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
        updateSlide();
      });

      // Dot navigation
      dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
          currentIndex = index;
          updateSlide();
        });
      });

      // Auto-advance every 5 seconds
      setInterval(() => {
        currentIndex = (currentIndex + 1) % totalSlides;
        updateSlide();
      }, 5000);

      // Initialize first dot as active
      dots[0].classList.add('active');
    });

    // ---------- Helpers ----------
function showGlobalError(msg) {
      const el = document.getElementById('globalError');
      el.textContent = msg;
      el.classList.remove('hidden');
    }
    function hideGlobalError() {
      const el = document.getElementById('globalError');
      el.classList.add('hidden');
      el.textContent = '';
    }
    function showModalError(msg) {
      const el = document.getElementById('modalError');
      el.textContent = msg;
      el.classList.remove('hidden');
    }
    function hideModalError() {
      const el = document.getElementById('modalError');
      el.classList.add('hidden');
      el.textContent = '';
    }
    function nightsBetween(checkIn, checkOut) {
      const a = new Date(checkIn);
      const b = new Date(checkOut);
      return (b - a) / (1000 * 60 * 60 * 24);
    }
    function showToast(title, msg) {
      const toast = document.getElementById('toast');
      document.getElementById('toastTitle').textContent = title || 'Thanks!';
      document.getElementById('toastMsg').textContent = msg || 'We will confirm your booking as soon as it‚Äôs successfully processed.';
      toast.classList.remove('hidden');
      setTimeout(() => toast.classList.add('hidden'), 5200);
    }
    function setBadge(key, state, message) {
      const el = document.getElementById(`availability-${key}`);
      // state: 'idle' | 'checking' | 'available' | 'unavailable' | 'error'
      if (!el) return;
      const clsBase = 'text-sm font-semibold';
      if (state === 'checking') { el.className = clsBase + ' text-gray-500'; el.textContent = 'Checking‚Ä¶'; }
      else if (state === 'available') { el.className = clsBase + ' text-green-700'; el.textContent = message || 'Available'; }
      else if (state === 'unavailable') { el.className = clsBase + ' text-red-600'; el.textContent = message || 'Unavailable'; }
      else if (state === 'error') { el.className = clsBase + ' text-gray-500'; el.textContent = message || 'Check dates'; }
      else { el.className = clsBase + ' text-gray-500'; el.textContent = '‚Äî'; }
    }
    function setBookEnabled(key, enabled) {
      const btn = document.querySelector(`.suiteBookBtn[data-key="${key}"]`);
      if (!btn) return;
      if (enabled) {
        btn.disabled = false;
        btn.classList.remove('btn-disabled');
      } else {
        btn.disabled = true;
        btn.classList.add('btn-disabled');
      }
    }
    function formatRangeLabel(ci, co) {
      if (!ci || !co) return '';
      return `Availability for ${ci} ‚Üí ${co}`;
    }

    // ---------- Modal ----------
    function openBookingModal(suiteName, suiteKey) {
      hideModalError();

      const globalCI = document.getElementById('globalCheckIn').value;
      const globalCO = document.getElementById('globalCheckOut').value;
      const globalGuests = document.getElementById('globalGuests').value;

      document.getElementById('suiteType').value = suiteName;
      document.getElementById('suiteKey').value = suiteKey;
      document.getElementById('modalTitle').textContent = `Request booking: ${suiteName}`;

      // Pre-fill from global search
      if (globalCI) document.getElementById('checkIn').value = globalCI;
      if (globalCO) document.getElementById('checkOut').value = globalCO;
      if (globalGuests) document.getElementById('guests').value = globalGuests;

      // Set min date to today
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('checkIn').min = today;

      document.getElementById('bookingModal').classList.remove('hidden');
    }

    function closeBookingModal() {
      document.getElementById('bookingModal').classList.add('hidden');
      document.getElementById('bookingForm').reset();
      hideModalError();
    }

    document.getElementById('closeModalBtn').addEventListener('click', closeBookingModal);
    document.getElementById('cancelBtn').addEventListener('click', closeBookingModal);

    // ---------- Availability ----------
    async function checkAvailability() {
      hideGlobalError();

      const checkIn = document.getElementById('globalCheckIn').value;
      const checkOut = document.getElementById('globalCheckOut').value;

      if (!checkIn || !checkOut) {
        showGlobalError('Please select both check-in and check-out dates.');
        return;
      }

      const nights = nightsBetween(checkIn, checkOut);
      if (!Number.isFinite(nights) || nights <= 0) {
        showGlobalError('Please make sure your check-out date is after your check-in date.');
        return;
      }
      if (nights < 2) {
        showGlobalError('Minimum stay is 2 nights. Please adjust your dates.');
        return;
      }

      document.getElementById('rangeLabel').textContent = formatRangeLabel(checkIn, checkOut);

      // UI: show checking state
      ['ember','sol','olive','azure','slate'].forEach(k => {
        setBadge(k, 'checking');
        setBookEnabled(k, false);
      });

      try {
        const url = `/.netlify/functions/availability?checkIn=${encodeURIComponent(checkIn)}&checkOut=${encodeURIComponent(checkOut)}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('Availability request failed');
        const data = await res.json();

        // Update each suite
        for (const key of ['ember','sol','olive','azure','slate']) {
          const available = !!data?.[key]?.available;
          if (available) {
            setBadge(key, 'available', 'Available');
            setBookEnabled(key, true);
          } else {
            setBadge(key, 'unavailable', 'Booked');
            setBookEnabled(key, false);
          }
        }
      } catch (e) {
        console.error(e);
        showGlobalError('Could not load availability right now. Please try again shortly.');
        ['ember','sol','olive','azure','slate'].forEach(k => {
          setBadge(k, 'error', 'Try again');
          setBookEnabled(k, false);
        });
      }
    }

    document.getElementById('checkBtn').addEventListener('click', checkAvailability);

    // Suite buttons open modal
    document.querySelectorAll('.suiteBookBtn').forEach(btn => {
      btn.addEventListener('click', () => {
        const suiteName = btn.getAttribute('data-suite');
        const suiteKey = btn.getAttribute('data-key');
        openBookingModal(suiteName, suiteKey);
      });
    });

    // ---------- Netlify Forms Submit + Toast ----------
    function encodeForm(data) {
      return Object.keys(data)
        .map(key => encodeURIComponent(key) + "=" + encodeURIComponent(data[key]))
        .join("&");
    }

    document.getElementById('bookingForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      hideModalError();

      const form = e.target;

      const formData = {
        "form-name": form.getAttribute("name"),
        "suite": document.getElementById('suiteType').value,
        "suiteKey": document.getElementById('suiteKey').value,
        "checkIn": document.getElementById('checkIn').value,
        "checkOut": document.getElementById('checkOut').value,
        "guests": document.getElementById('guests').value,
        "name": document.getElementById('name').value,
        "email": document.getElementById('email').value,
        "phone": document.getElementById('phone').value,
        "notes": document.getElementById('notes').value,
      };

      // Validate minimum 2 nights
      const nights = nightsBetween(formData.checkIn, formData.checkOut);
      if (!Number.isFinite(nights) || nights <= 0) {
        showModalError('Please make sure your check-out date is after your check-in date.');
        return;
      }
      if (nights < 2) {
        showModalError('Minimum stay is 2 nights. Please adjust your dates.');
        return;
      }

      // Optional: quick re-check availability before sending (prevents requesting booked suite)
      try {
        const url = `/.netlify/functions/availability?checkIn=${encodeURIComponent(formData.checkIn)}&checkOut=${encodeURIComponent(formData.checkOut)}`;
        const res = await fetch(url);
        const avail = await res.json();
        const key = formData.suiteKey;
        if (avail?.[key] && avail[key].available === false) {
          showModalError('That suite is no longer available for your selected dates. Please choose a different suite or dates.');
          return;
        }
      } catch (_) {
        // If availability check fails, still allow request to go through (optional). You can block if you prefer.
      }

      const submitBtn = document.getElementById('submitBtn');
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Submitting‚Ä¶';
      submitBtn.disabled = true;

      try {
        // Netlify Forms submission (POST to the site root)
        const response = await fetch("/", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: encodeForm(formData),
        });

        if (!response.ok) throw new Error("Form submission failed");

        closeBookingModal();
        showToast(
          "Thanks! ‚úÖ",
          "Your booking request was received. We will confirm your booking as soon as it‚Äôs successfully processed."
        );

        // Refresh availability after submit
        await checkAvailability();
      } catch (err) {
        console.error(err);
        showModalError("There was an error submitting your request. Please try again or email stay@villagehub.co.za.");
      } finally {
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      }
    });

    // ---------- Initialize defaults ----------
    document.addEventListener('DOMContentLoaded', () => {
      // Set min dates + default check-in to today and check-out to +2 days
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      const todayStr = `${yyyy}-${mm}-${dd}`;

      const plus2 = new Date(today);
      plus2.setDate(today.getDate() + 2);
      const yyyy2 = plus2.getFullYear();
      const mm2 = String(plus2.getMonth() + 1).padStart(2, '0');
      const dd2 = String(plus2.getDate()).padStart(2, '0');
      const plus2Str = `${yyyy2}-${mm2}-${dd2}`;

      const ci = document.getElementById('globalCheckIn');
      const co = document.getElementById('globalCheckOut');
      ci.min = todayStr;
      co.min = todayStr;

      // If empty, set defaults
      if (!ci.value) ci.value = todayStr;
      if (!co.value) co.value = plus2Str;

      document.getElementById('rangeLabel').textContent = formatRangeLabel(ci.value, co.value);

      // Optionally auto-check on load:
      // checkAvailability();
    });
  </script>
</body>
</html>
